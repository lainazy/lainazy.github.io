<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å‡Œå­äº¦ Â· ğŸ“™ | æµè§ˆå™¨å­¦ä¹ è®°å½•</title>
    <meta name="description" content="å†™å†™ç¬”è®°ä»€ä¹ˆçš„">
    
    
    <link rel="preload" href="/assets/css/0.styles.c4669b9b.css" as="style"><link rel="preload" href="/assets/js/app.3681f687.js" as="script"><link rel="preload" href="/assets/js/23.c8a50afe.js" as="script"><link rel="prefetch" href="/assets/js/14.01a12aed.js"><link rel="prefetch" href="/assets/js/1.79e91ea3.js"><link rel="prefetch" href="/assets/js/2.7e8556b8.js"><link rel="prefetch" href="/assets/js/3.70d4f9b7.js"><link rel="prefetch" href="/assets/js/4.aa815117.js"><link rel="prefetch" href="/assets/js/5.57119d85.js"><link rel="prefetch" href="/assets/js/6.0a80ff83.js"><link rel="prefetch" href="/assets/js/7.e6c6f51a.js"><link rel="prefetch" href="/assets/js/8.64d123c3.js"><link rel="prefetch" href="/assets/js/9.5fc801b0.js"><link rel="prefetch" href="/assets/js/10.a985a241.js"><link rel="prefetch" href="/assets/js/11.00572892.js"><link rel="prefetch" href="/assets/js/12.8ed540dd.js"><link rel="prefetch" href="/assets/js/13.83e6fb9b.js"><link rel="prefetch" href="/assets/js/15.ffcd0199.js"><link rel="prefetch" href="/assets/js/16.8ba4a225.js"><link rel="prefetch" href="/assets/js/17.ebd63263.js"><link rel="prefetch" href="/assets/js/18.97452dce.js"><link rel="prefetch" href="/assets/js/19.55416f59.js"><link rel="prefetch" href="/assets/js/20.69494a9a.js"><link rel="prefetch" href="/assets/js/21.84cbdbe9.js"><link rel="prefetch" href="/assets/js/22.c6401b09.js"><link rel="prefetch" href="/assets/js/24.15eae7cb.js"><link rel="prefetch" href="/assets/js/25.3ef7ac3e.js"><link rel="prefetch" href="/assets/js/26.0ddc27ca.js"><link rel="prefetch" href="/assets/js/27.d8311d7d.js"><link rel="prefetch" href="/assets/js/28.7c8da951.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c4669b9b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      å‡Œå­äº¦ Â· ğŸ“™
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Articles</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/jottings/" class="nav-link router-link-active">éšç¬”</a></li><li class="dropdown-item"><!----><a href="/blogs/" class="nav-link">åšå®¢</a></li></ul></div></div><a href="https://github.com/lainazy" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Articles</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/jottings/" class="nav-link router-link-active">éšç¬”</a></li><li class="dropdown-item"><!----><a href="/blogs/" class="nav-link">åšå®¢</a></li></ul></div></div><a href="https://github.com/lainazy" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>è‡ªä¸»å­¦ä¹ </span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/learn-by-self.html" class="sidebar-link">æ‚è®°</a></li><li><a href="/jottings/design-pattern.html" class="sidebar-link">è®¾è®¡æ¨¡å¼</a></li><li><a href="/jottings/web-security.html" class="sidebar-link">webå®‰å…¨åŠå¤„ç†</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>æµè§ˆå™¨</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/browser-study.html" class="active sidebar-link">æµè§ˆå™¨å­¦ä¹ è®°å½•</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/jottings/network.html" class="sidebar-link">ç½‘ç»œæ•°æ®ä¼ è¾“åŸç†</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Http</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/http-status-code.html" class="sidebar-link">http å¸¸è§çŠ¶æ€ç </a></li><li><a href="/jottings/http-study.html" class="sidebar-link">Http åè®®ç›¸å…³è®°å½•</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Css</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/css-often-used.html" class="sidebar-link">CSS å¸¸ç”¨æ ·å¼è®°å½•</a></li><li><a href="/jottings/css-study.html" class="sidebar-link">CSS å­¦ä¹ è®°å½•</a></li><li><a href="/jottings/scss.html" class="sidebar-link">Scss ä½¿ç”¨æŒ‡å—</a></li><li><a href="/jottings/stylus.html" class="sidebar-link">Stylus è®°å½•</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Javascript</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/js-study.html" class="sidebar-link">Javascript å­¦ä¹ è®°å½•</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DOM</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/dom-study.html" class="sidebar-link">DOM ç¬”è®°</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Vue</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/vuepress-use.html" class="sidebar-link">VuePress ä½¿ç”¨æŒ‡å—</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>React</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/react-hooks.html" class="sidebar-link">React Hooks</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Webpack</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/webpack.html" class="sidebar-link">Webpackç›¸å…³è®°å½•</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Git</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/git-cmd.html" class="sidebar-link">Git å‘½ä»¤</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Linux</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/linux-cmd.html" class="sidebar-link">Linux å‘½ä»¤å­¦ä¹ è®°å½•</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Docker</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/docker-often-used.html" class="sidebar-link">Docker å¸¸ç”¨å‘½ä»¤è®°å½•</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>é¡¹ç›®è§„èŒƒ</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/husky.html" class="sidebar-link">husky &amp; lint-staged ä½¿ç”¨è®°å½•</a></li><li><a href="/jottings/commitlint.html" class="sidebar-link">commitizen &amp; commitlint ä½¿ç”¨è®°å½•</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>æŒç»­é›†æˆ</span><!----></p><ul class="sidebar-group-items"><li><a href="/jottings/travis-use.html" class="sidebar-link">Travis CI ä½¿ç”¨æ‘˜è¦</a></li><li><a href="/jottings/gitlab-ci-use.html" class="sidebar-link">Gitlab CI ä½¿ç”¨æ‘˜è¦</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h3 id="æµè§ˆå™¨å¤šçº¿ç¨‹"><a href="#æµè§ˆå™¨å¤šçº¿ç¨‹" aria-hidden="true" class="header-anchor">#</a> æµè§ˆå™¨å¤šçº¿ç¨‹</h3><ul><li><strong><em>Javascript å¼•æ“çº¿ç¨‹</em></strong> (å•çº¿ç¨‹è¿è¡Œä¸”ä¸ GUI æ¸²æŸ“çº¿ç¨‹äº’æ–¥ï¼Œè„šæœ¬æ‰§è¡Œä¼šé˜»å¡ Http è¯·æ±‚çº¿ç¨‹(å³é˜»å¡èµ„æºçš„ä¸‹è½½)å’Œç½‘ä¸Šæ‰€è¯´çš„æœ‰ç‚¹å†²çª)</li><li><strong><em>GUI æ¸²æŸ“çº¿ç¨‹</em></strong> (ä¸ Javascript å¼•æ“çº¿ç¨‹äº’æ–¥ï¼Œæ¸²æŸ“æ ‘çš„æ„å»ºä¼šç­‰å¾… css è§£æå®Œæˆ)</li><li><strong><em>äº‹ä»¶è§¦å‘çº¿ç¨‹</em></strong></li><li><strong><em>å®šæ—¶è§¦å‘å™¨çº¿ç¨‹</em></strong> (setTimeout)</li><li><strong><em>Http è¯·æ±‚çº¿ç¨‹</em></strong> (åŒä¸€ä¸ªä¸»æœºæœ‰æœ€å¤§å¹¶è¡Œè¿æ¥æ•°é™åˆ¶)
<ul><li>css èµ„æºä¸‹è½½å’Œè§£ææ—¶ä¼šé˜»å¡ GUI æ¸²æŸ“çº¿ç¨‹(é˜»å¡æ¸²æŸ“æ ‘(rendering tree)æ¸²æŸ“ï¼Œä¸é˜»å¡ DOM è§£æ)</li><li>js èµ„æºä¸‹è½½å’Œæ‰§è¡Œæ—¶ä¼šé˜»å¡ GUI æ¸²æŸ“çº¿ç¨‹(é˜»å¡ DOM è§£æå’Œæ¸²æŸ“æ ‘(rendering tree)æ¸²æŸ“)</li><li>æœ‰äº›æµè§ˆå™¨(safariã€chromeã€firefox ç­‰)åœ¨ css èµ„æºä¸‹è½½å’Œè§£ææ—¶ä¼šå»¶è¿Ÿå…¶ä¹‹åçš„ js ä»£ç çš„æ‰§è¡Œ(ä¸é˜»å¡ js èµ„æºä¸‹è½½)</li></ul></li></ul><p><strong><em>ä¸ªäººç†è§£ï¼šèµ„æºçš„ä¸‹è½½åº”è¯¥åˆ†ä¸ºåŒæ­¥ä¸‹è½½(é˜»å¡ GUI æ¸²æŸ“çº¿ç¨‹)å’Œå¼‚æ­¥ä¸‹è½½(ä¸é˜»å¡ GUI æ¸²æŸ“çº¿ç¨‹)ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰èµ„æºéƒ½ä¸ºåŒæ­¥ä¸‹è½½ï¼Œscript æ ‡ç­¾åŠ  defer åä¸ºå¼‚æ­¥ä¸‹è½½</em></strong></p><h3 id="event-loops"><a href="#event-loops" aria-hidden="true" class="header-anchor">#</a> Event loops</h3><ul><li>æµè§ˆå™¨å¿…é¡»ä½¿ç”¨äº‹ä»¶å¾ªç¯(event loops)åè°ƒå¼‚æ­¥(äº‹ä»¶ã€æ¥å£ã€è„šæœ¬ã€æ¸²æŸ“ã€ç½‘ç»œç­‰)ã€‚</li><li>äº‹ä»¶å¾ªç¯æœ‰å¯¹åº” browsing contexts å’Œ workers çš„ä¸¤ç§ç±»å‹ã€‚</li><li>ä¸€ä¸ªäº‹ä»¶å¾ªç¯(event loop)æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—(task queue)ã€‚</li><li>ä»»åŠ¡(task)é€šå¸¸æœ‰ 4 ç§ä»»åŠ¡æº(task source)ï¼š
<ul><li>DOM æ“ä½œä»»åŠ¡æº(DOM manipulation task source)</li><li>ç”¨æˆ·äº¤äº’ä»»åŠ¡æº(user interaction task source)</li><li>ç½‘ç»œè¯·æ±‚ä»»åŠ¡æº(networking task source)</li><li>æµè§ˆå™¨å†å²ä»»åŠ¡æº(history traversal task source)</li></ul></li><li>æ¥è‡ªåŒä¸€ä¸ª task source çš„æ‰€æœ‰ä»»åŠ¡å¿…é¡»æ”¾å…¥åŒä¸€ä¸ª task queueï¼Œå³ä¸€ç§ task source å¯¹åº”ä¸€ä¸ª task queueã€‚åŒä¸€ä¸ª task queue æ˜¯æŒ‰å…ˆè¿›å…ˆå‡ºé¡ºåºæ‰§è¡Œçš„ã€‚</li><li>æµè§ˆå™¨å¯ä»¥æ ¹æ® task queue ä¸­ task source çš„ä¸åŒï¼Œç»™äºˆ task queue ä¸åŒçš„ä¼˜å…ˆçº§ã€‚ç”±æµè§ˆå™¨å†³å®šæŒ‘å“ªä¸€ä¸ª task queue ä¸­çš„é˜Ÿé¦– task æ‰§è¡Œã€‚</li><li>ä»»åŠ¡(task)åˆ†ä¸ºä¸¤ç±»ï¼š
<ul><li>å®ä»»åŠ¡(task)ï¼šscript(js codes as a whole in script tag), setTimeout|setInterval, setImmediate, requestAnimationFrame, I/O, UI rendering.</li><li>å¾®ä»»åŠ¡(micro-task)ï¼šprocess.nextTick, Promise(callback function in then), Object.observe, MutationObserver.</li></ul></li><li>js å¼•æ“ä¼šæŠŠ task push åˆ°å¯¹åº”çš„ task queue æˆ– microtask queue ä¸­ã€‚</li><li>åœ¨ event loop çš„ä¸€ä¸ªå›åˆä¸­ï¼Œä¼šå…ˆä» task queue ä¸­å–å‡ºé˜Ÿé¦–çš„ task è¿›è¡Œæ‰§è¡Œï¼›æ‰§è¡Œå®Œæ¯•åï¼Œå†ä¾æ¬¡æ‰§è¡Œ microtask queue ä¸­çš„æ‰€æœ‰ä»»åŠ¡ï¼›å¦‚æœåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ·»åŠ äº†æ–°çš„ microtaskï¼Œåˆ™ä¼šåœ¨å½“å‰çš„å›åˆä¸­ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°å…¨éƒ¨ mircotask æ‰§è¡Œå®Œæ¯•æ‰è¿›å…¥ä¸‹ä¸€ä¸ª event loop å›åˆã€‚</li><li>äº‹ä»¶å¾ªç¯æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</li></ul><pre class="language-bash"><code>An event loop must continually run through the following steps <span class="token keyword">for</span> as long as it exists:
     1. <span class="token keyword">select</span> the oldest task<span class="token punctuation">(</span>task A<span class="token punctuation">)</span> <span class="token keyword">in</span> task queues.If task A is null<span class="token punctuation">(</span>means task queues is empty<span class="token punctuation">)</span>,jump to step 5<span class="token punctuation">(</span>microtasks steps<span class="token punctuation">)</span>
     2. <span class="token keyword">set</span> <span class="token string">&quot;currently running task&quot;</span> to <span class="token string">&quot;task A&quot;</span>
     3. run <span class="token string">&quot;task A&quot;</span><span class="token punctuation">(</span>means run the callback function<span class="token punctuation">)</span>
     4. <span class="token keyword">set</span> <span class="token string">&quot;currently running task&quot;</span> back to null,and remove <span class="token string">&quot;task A&quot;</span> from its task queue
     5. perform microtask queue
        <span class="token punctuation">(</span>a<span class="token punctuation">)</span>. <span class="token keyword">select</span> the oldest task<span class="token punctuation">(</span>task x<span class="token punctuation">)</span> <span class="token keyword">in</span> microtask queue
        <span class="token punctuation">(</span>b<span class="token punctuation">)</span>. <span class="token keyword">if</span> task x is null<span class="token punctuation">(</span>means microtask queues is empty<span class="token punctuation">)</span>,jump to step <span class="token punctuation">(</span>g<span class="token punctuation">)</span>
        <span class="token punctuation">(</span>c<span class="token punctuation">)</span>. <span class="token keyword">set</span> <span class="token string">&quot;currently running task&quot;</span> to <span class="token string">&quot;task x&quot;</span>
        <span class="token punctuation">(</span>d<span class="token punctuation">)</span>. run <span class="token string">&quot;task x&quot;</span>
        <span class="token punctuation">(</span>e<span class="token punctuation">)</span>. <span class="token keyword">set</span> <span class="token string">&quot;currently running task&quot;</span> to null,remove <span class="token string">&quot;task x&quot;</span> from the microtask queue
        <span class="token punctuation">(</span>f<span class="token punctuation">)</span>. <span class="token keyword">select</span> next oldest task <span class="token keyword">in</span> microtask queue,jump to step<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
        <span class="token punctuation">(</span>g<span class="token punctuation">)</span>. finish microtask queue
     6. update rendering
     7. next routnd:jump to step 1
</code></pre><ul><li>æ¸²æŸ“é˜Ÿåˆ—(Render queue)ï¼šæµè§ˆå™¨åœ¨ 1s ä¸­æ¸²æŸ“é¡µé¢ 60 æ¬¡ï¼Œæ¯ 16ms å°±ä¼šå¾€ Render queue ä¸­æ·»åŠ ä¸€ä¸ª UI render ä»»åŠ¡ã€‚ä½†æ˜¯æµè§ˆå™¨åªæœ‰åœ¨è°ƒç”¨æ ˆ(Call stack)ä¸ºç©ºæ—¶æ‰æœ‰æœºä¼šæ‰§è¡Œè¯¥ä»»åŠ¡ã€‚</li><li>microtask ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ä¼šå¯¼è‡´ UI æ¸²æŸ“çš„é˜»å¡å’Œåç»­çš„ macrotask ä»»åŠ¡çš„é˜»å¡ã€‚</li><li>nodejs çš„ process.nextTick é™åˆ¶ 1000 ä¸ª tick ä»»åŠ¡ã€‚</li></ul><p><strong>ä¸€æ¬¡äº‹ä»¶å¾ªç¯å‘¨æœŸ = ä¸€ä¸ªå®ä»»åŠ¡ + å½“å‰å®ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¤šä¸ªå¾®ä»»åŠ¡ + ä¸€æ¬¡æ¸²æŸ“æœºä¼š + æ£€æŸ¥æ˜¯å¦æœ‰ web worker ä»»åŠ¡éœ€è¦æ‰§è¡Œ</strong></p><p><strong>ä¸€æ¬¡äº‹ä»¶å¾ªç¯å‘¨æœŸå¹¶ä¸ä¸€å®šä¼šæ‰§è¡Œä¸€æ¬¡æ¸²æŸ“ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€æ¬¡æ£€æŸ¥æ˜¯å¦éœ€è¦æ¸²æŸ“çš„æœºä¼šï¼Œæ£€æŸ¥ render queue ä¸­æ˜¯å¦æœ‰æ¸²æŸ“ä»»åŠ¡ã€‚å¦‚æœæœ‰requestAnimationFrameä»»åŠ¡ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“ä¹‹å‰æ‰§è¡Œã€‚</strong></p><p>ç›¸å…³é“¾æ¥ï¼š</p><blockquote><p><a href="http://www.cnblogs.com/kevin2chen/p/6415630.html" target="_blank" rel="noopener noreferrer">æµè§ˆå™¨ç»„æˆã€çº¿ç¨‹åŠ event loop</a> &gt; <a href="http://www.jianshu.com/p/12b9f73c5a4f" target="_blank" rel="noopener noreferrer">è¯¦è§£äº‹ä»¶å¾ªç¯æœºåˆ¶</a></p></blockquote><h1 id="nodejs-event-loops"><a href="#nodejs-event-loops" aria-hidden="true" class="header-anchor">#</a> Nodejs Event loops</h1><p>å¤§è‡´å¯åˆ†ä¸ºå…­ä¸ªé˜¶æ®µï¼š</p><ul><li>timer(è°ƒç”¨setTimeout/setIntervalçš„å›è°ƒ)</li><li>I/O(pending) callback(æ¢æŸ¥éœ€è¦å¤„ç†çš„IOäº‹ä»¶ï¼Œå¹¶æ”¾å…¥ä¸€ä¸ªio pendingäº‹ä»¶é˜Ÿåˆ—ï¼Œæœ¬è´¨ä¸Šæ˜¯pollé˜¶æ®µçš„ä¸€ä¸ªè¡ç”Ÿéƒ¨åˆ†ï¼Œå¦‚æœpendingäº‹ä»¶å‘ç”Ÿäº†errorï¼Œä¹Ÿä¼šåœ¨è¿™ä¸ªé˜¶æ®µæ‰§è¡Œ)</li><li>Idleã€prepare(ç©ºé—²ã€å‡†å¤‡é˜¶æ®µï¼Œnodeå†…éƒ¨å¤„ç†æœºåˆ¶ï¼Œä¸éœ€è¦å…³å¿ƒ)</li><li>poll(è½®å¾ªé˜¶æ®µï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªè°ƒåº¦é˜¶æ®µï¼Œç”¨æ¥æ§åˆ¶è½®è¯¢æµç¨‹ï¼Œå¦‚æ¯å½“io eventçŠ¶æ€ä»pendingå˜æˆcompleteæ—¶ï¼Œå°±ä¼šå°†io eventå›è°ƒæ”¾å…¥poll queueï¼Œpollé˜¶æ®µä¼šè‡ªåŠ¨å»æ£€æŸ¥poll queueï¼Œå½“poll queueæœ‰io eventå›è°ƒæ—¶ï¼Œå°±å»æ‰§è¡Œäº‹ä»¶å›è°ƒï¼Œå¯èƒ½æ‰§è¡Œè¿‡ç¨‹ä¸­åˆæœ‰æ–°çš„äº‹ä»¶å›è°ƒåŠ å…¥åˆ°pollé˜Ÿåˆ—ä¸­ï¼Œæ‰€ä»¥æ‰§è¡Œå®Œä¸Šä¸€ä¸ªäº‹ä»¶å›è°ƒåï¼Œå‘ç°pollé˜Ÿåˆ—ä¸­è¿˜æœ‰äº‹ä»¶å›è°ƒï¼Œä¼šç»§ç»­æ‰§è¡Œæ–°çš„äº‹ä»¶å›è°ƒï¼Œç›´åˆ°pollé˜Ÿåˆ—æ¸…ç©ºæˆ–è€…æ‰§è¡Œçš„å›è°ƒä¸ªæ•°è¾¾åˆ°ç³»ç»Ÿç¡¬æ€§æœ€å¤§é™åˆ¶æ‰ä¼šç»§ç»­ä¸‹ä¸€ä¸ªè½®è¯¢ï¼Œå½“pollé˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œä¼šå»æŸ¥çœ‹setImmediateå›è°ƒé˜Ÿåˆ—æ˜¯å¦æœ‰immediateå›è°ƒï¼Œæœ‰çš„è¯ä¼šè¿›å…¥åˆ°checké˜¶æ®µå»æ‰§è¡Œimmediateå›è°ƒï¼Œæ²¡æœ‰çš„è¯ä¼šå»æŸ¥çœ‹timerå›è°ƒé˜Ÿåˆ—æ˜¯å¦æœ‰åˆ°æ—¶çš„å®šæ—¶å™¨å›è°ƒï¼ˆå’Œioäº‹ä»¶ä¸€æ ·ï¼Œåˆ°æ—¶çš„å®šæ—¶å™¨å›è°ƒæ‰ä¼šè¢«æ”¾å…¥timerå›è°ƒé˜Ÿåˆ—ï¼‰ï¼Œæœ‰çš„è¯å°±è·³å›è°ƒtimeré˜¶æ®µå»æ‰§è¡Œå®šæ—¶å™¨å›è°ƒï¼ˆå½“ç„¶è·³å›timeré˜¶æ®µè¿‡ç¨‹ä¸­ä¹Ÿä¼šç»è¿‡checkå’Œcloseé˜¶æ®µï¼‰ï¼Œå¦‚æœpollé˜Ÿåˆ—ä¸ºç©ºï¼Œtimeré˜Ÿåˆ—å’Œimmediateé˜Ÿåˆ—ä¹Ÿéƒ½ä¸ºç©ºï¼Œpollé˜¶æ®µå°†è¿›å…¥é˜»å¡çŠ¶æ€)</li><li>check(checké˜¶æ®µï¼ŒsetImmediateå›è°ƒåœ¨æ­¤é˜¶æ®µæ‰§è¡Œ)</li><li>close callback(å…³é—­äº‹ä»¶å›è°ƒé˜¶æ®µ)</li></ul><p><a href="https://github.com/nodejs/help/issues/1118" target="_blank" rel="noopener noreferrer">Github issue: event loopåˆ°åº•æ€ä¹ˆå·¥ä½œ</a></p><p><em>å¾®ä»»åŠ¡åœ¨ä¸Šé¢è¿™äº›é˜¶æ®µä¹‹é—´æ‰§è¡Œã€‚</em>
process.nextTické˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡åœ¨promiseé˜Ÿåˆ—çš„æ‰€æœ‰å¾®ä»»åŠ¡ä¹‹å‰æ‰§è¡Œã€‚
åœ¨node11.0ä¹‹å‰ï¼Œä¼šä¸€æ¬¡è¡Œå…ˆæ‰§è¡Œå®Œå®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å®ä»»åŠ¡ï¼Œåœ¨å¼€å§‹æ‰§è¡Œå¾®ä»»åŠ¡å’Œåé¢é˜¶æ®µï¼Œå¦‚timeré˜Ÿåˆ—ä¸­æœ‰3ä¸ªä»»åŠ¡ï¼Œä¼šä¸€æ¬¡æ€§ä¾æ¬¡æ‰§è¡Œå®Œ3ä¸ªtimerå›è°ƒï¼Œç„¶åæ‰å¼€å§‹æ‰§è¡Œå…¶ä¸­äº§ç”Ÿçš„å¾®ä»»åŠ¡ï¼Œç„¶åå†è¿›å…¥åé¢çš„é˜¶æ®µã€‚åœ¨node11.0ä¹‹åï¼Œæ”¹æˆäº†ä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ã€‚è½®è¯¢é˜Ÿåˆ—çš„äº‹ä»¶å¤„ç†æ˜¯å¦ä¹Ÿæ˜¯æ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ªæœ‰å¾…æŸ¥è¯ã€‚</p><p><a href="https://blog.csdn.net/qq_38774121/article/details/97680282" target="_blank" rel="noopener noreferrer">Node.js 11Version ç‰ˆæœ¬ä¹‹å åº•å±‚çš„ä»»åŠ¡æ‰§è¡Œæ ˆçš„é—®é¢˜ï¼Œå®ä»»åŠ¡ä¸å¾®ä»»åŠ¡æ‰§è¡Œçš„é¡ºåºåšå‡ºäº†æ”¹å˜</a></p></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        â† <a href="/jottings/web-security.html" class="prev">
          webå®‰å…¨åŠå¤„ç†
        </a></span><span class="next"><a href="/jottings/network.html">
          ç½‘ç»œæ•°æ®ä¼ è¾“åŸç†
        </a> â†’
      </span></p></div></div></div></div>
    <script src="/assets/js/23.c8a50afe.js" defer></script><script src="/assets/js/app.3681f687.js" defer></script>
  </body>
</html>
